

<img src="https://github.com/Yongli-Lisa/Linux-Notes1/blob/b4a1783638ce9439eeecc42f596f3393422c9cbd/Img/%E8%99%9A%E6%8B%9F%E5%8C%96/%E8%99%9A%E6%8B%9F%E5%8C%96.PNG" width="900px">  



  

虚拟化的本质是用 qemu 的软件模拟硬件，但是模拟方式比较慢，需要加速；  
虚拟化主要模拟 CPU、内存、网络、存储，分别有不同的加速办法；  
CPU 和内存主要使用硬件辅助虚拟化进行加速，需要配备特殊的硬件才能工作；  
网络和存储主要使用特殊的半虚拟化驱动加速，需要加载特殊的驱动程序。  

**全虚拟化：**  
虚拟化软件会模拟假的 CPU、内存、网络、硬盘给虚拟机。  
虚拟化的本质是用 qemu 的软件模拟硬件，但是模拟方式比较慢，需要加速.  

  
**硬件辅助虚拟化：**  
对于虚拟机内核来讲，只要将标志位设为虚拟机状态，就可以直接在 CPU 上执行大部分的指令，不需要虚拟化软件在中间转述，除非遇到特别敏感的指令，才需要将标志位设为物理机内核态运行，这样大大提高了效率。  
硬件辅助虚拟化技术 Intel-VT，AMD-V，需要 CPU 硬件开启这个标志位，一般在 BIOS 里面设置. 当确认开始了标志位之后，通过 KVM，GuestOS 的 CPU 指令不用经过 Qemu 转译，直接运行。   
CPU 和内存主要使用硬件辅助虚拟化进行加速，需要配备特殊的硬件才能工作.  

**半虚拟化:**  
GuestOS 知道自己是虚拟机，所以数据会直接发送给半虚拟化设备，经过特殊处理（例如排队、缓存、批量处理等性能优化方式），最终发送给真正的硬件。  
网络和存储主要使用特殊的半虚拟化驱动加速，需要加载特殊的驱动程序。    
<img src="https://github.com/Yongli-Lisa/Linux-Notes1/blob/b4a1783638ce9439eeecc42f596f3393422c9cbd/Img/%E8%99%9A%E6%8B%9F%E5%8C%96/%E5%8D%8A%E8%99%9A%E6%8B%9F%E5%8C%96.PNG" width="500px">  


